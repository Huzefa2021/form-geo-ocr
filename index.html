<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Municipal Corporation of Greater Mumbai â€” Abandoned Vehicles (Marshal Upload)</title>
  <link rel="stylesheet" href="styles.css?v=2025.09.25.M1" />
  <!-- Tesseract v5 (jsDelivr) -->
  <script defer src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
  <script defer src="app.js?v=2025.09.25.M1"></script>
</head>
<body>

<!-- Header -->
<header class="app-header">
  <!-- LEFT: MCGM logo + titles -->
  <div class="hdr-left">
    <div class="logo-left">
      <img class="mcgm-logo" src="https://www.mcgm.gov.in/com.mcgm.newframework/images/logo_V1.png" alt="MCGM">
    </div>
    <div class="hdr-title">
      <div class="t1">Municipal Corporation of Greater Mumbai</div>
      <div class="t2">Abandoned Vehicles â€” Identification &amp; Pre-Notice (Marshal Upload)</div>
      <div class="t2">Link to download camera app â€” <a href="https://gpsmapcamera.com/" target="_blank" rel="noopener">Click Here</a></div>
    </div>
  </div>

  <!-- RIGHT: badges, reset, Crescendo logo -->
  <div class="hdr-right">
    <div class="hdr-right-stack">
      <span id="cdnBadge" class="badge badge-info">CDN: v5 (Loadingâ€¦)</span>
      <span id="geoBadge" class="badge badge-warn">Geo: Loadingâ€¦</span>
      <button id="btnReset" class="btn btn-danger">Reset</button>
    </div>

    <div class="logo-right">
      <img class="crescendo-logo" src="data/crescendo-logo.png" alt="Crescendo Innovative Solutions">
    </div>
  </div>
</header>

  <!-- Sticky Pills -->
  <section id="pillBar" class="pillbar">
    <button class="pill" id="pill-upload"><span>Upload</span></button>
    <button class="pill" id="pill-ocr"><span>OCR</span></button>
    <button class="pill" id="pill-parse"><span>Parse</span></button>
    <button class="pill" id="pill-geo"><span>GeoJSON</span></button>
    <button class="pill" id="pill-review"><span>Review</span></button>
    <button class="pill" id="pill-redirect" title="Opens Google Form"><span>Redirect</span></button>
  </section>

  <!-- Sticky Banner -->
  <div id="banner" class="banner info" hidden>Updates will appear hereâ€¦</div>

  <!-- Main -->
  <main class="container">
    <div class="grid">
      <section class="card">
        <h3>Upload &amp; Previews</h3>

        <div id="dropArea" class="droparea" tabindex="0" role="button" aria-label="Tap or drop to choose image">
          <div class="drop-invite">
            <div class="cam-emoji">ðŸ“·</div>
            <div class="txt-1">Tap to choose image</div>
            <div class="txt-2">or drag &amp; drop (JPG/PNG from GPS Map Camera)</div>
          </div>
          <input id="fileInput" type="file" accept="image/jpg,image/jpeg,image/png,image/webp,image/bmp,image/gif" class="hidden-input" />
        </div>

        <div class="preview-grid">
          <figure class="preview-col">
            <figcaption>Original Preview</figcaption>
            <img id="imgOriginal" class="preview-img" alt="Original Preview" />
          </figure>
          <figure class="preview-col">
            <figcaption>Cropped HUD Preview</figcaption>
            <img id="imgCrop" class="preview-img" alt="Cropped HUD Preview" />
             <!-- Put this just under the Cropped HUD Preview image/figure -->
               <button id="openManual" type="button" class="toolbtn" style="display:none">
                  Adjust cropâ€¦
                </button>
          </figure>
        </div>
      </section>

      <section class="card">
        <h3>Results</h3>
        <div class="results">
          <dl>
            <dt>Date</dt><dd id="resDate">â€”</dd>
            <dt>Time</dt><dd id="resTime">â€”</dd>
            <dt>Latitude</dt><dd id="resLat">â€”</dd>
            <dt>Longitude</dt><dd id="resLon">â€”</dd>
            <dt>Address</dt><dd id="resAddr">â€”</dd>
            <dt>Ward</dt><dd id="resWard">â€”</dd>
            <dt>Beat No.</dt><dd id="resBeat">â€”</dd>
            <dt>Police Station</dt><dd id="resPS">â€”</dd>
          </dl>
        </div>

        <div id="console-box" class="console-box card-inset">
          <div class="console-head">
            <strong>Console Output</strong>
            <div class="console-actions">
              <button id="consoleCopy" class="btn btn-primary btn-xxs" type="button">Copy</button>
              <button id="consoleToggle" class="btn btn-primary btn-xxs" type="button" aria-expanded="true">Hide</button>
            </div>
          </div>
          <pre id="console-pre" aria-live="polite">Logs will appear hereâ€¦</pre>
        </div>
      </section>
    </div>
    <!-- Manual Crop Editor -->
<dialog id="manualDialog" class="mc-modal" aria-labelledby="mcTitle">
  <div class="mc">
    <div class="mc-head">
      <strong id="mcTitle">Adjust crop</strong>
      <div class="mc-actions">
        <button id="mcCancel" type="button">Cancel</button>
        <button id="mcReset"  type="button">Reset</button>
        <button id="mcApply"  type="button" class="primary">Use selection</button>
      </div>
    </div>

    <div id="mcStage" class="mc-stage">
      <!-- wrapper sized to the rendered image; box sits on top -->
      <div id="mcCanvas" class="mc-canvas">
        <img id="mcImg" alt="Preview for manual crop"/>
        <div id="mcBox" class="mc-box" role="region" aria-label="Crop area" tabindex="0">
          <span class="mc-h mc-h-nw" data-dir="nw"></span>
          <span class="mc-h mc-h-n"  data-dir="n"></span>
          <span class="mc-h mc-h-ne" data-dir="ne"></span>
          <span class="mc-h mc-h-e"  data-dir="e"></span>
          <span class="mc-h mc-h-se" data-dir="se"></span>
          <span class="mc-h mc-h-s"  data-dir="s"></span>
          <span class="mc-h mc-h-sw" data-dir="sw"></span>
          <span class="mc-h mc-h-w"  data-dir="w"></span>
        </div>
      </div>
    </div>
    <p class="mc-hint">Tip: drag to move, use handles to resize, or use arrow keys (Shift = Ã—10px).</p>
  </div>
</dialog>
  </main>

  <!-- Sticky Footer -->
<footer class="app-footer">
  <div class="ftext">
    <div>Â© 2025 <strong>Municipal Corporation of Greater Mumbai (MCGM)</strong></div>
    <div>Developed by <strong>Crescendo Innovative Solutions LLP</strong></div>
    <div>Admin: <strong>Huzefa Kathawala</strong> Â· <a href="mailto:huzefa.k@crescendoits.com">huzefa.k@crescendoits.com</a></div>
    <div><span id="buildId">Build: v2025.09.25.M1</span></div>
  </div>
</footer>
</body>
</html>
